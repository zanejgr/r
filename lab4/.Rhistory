knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
View(spruce)
View(spruce)
normcheck(spruce.lm,shapiro.wilk = TRUE)
#This will be a different path if in the lab or at home
dird="E:\\OneDrive\\MATH4753\\DATAxls\\"
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
getwd()
tail(spruce)
spruce%T>%trendscatter(x=.$Height,y=.$BHDiameter,f=0.5)%>%lm()->spruce.lm
spruce.lm%T>%{residuals(.)->>height.res}%>%fitted->height.fit
qplot(x=height.res,y=height.fit)
trendscatter(x=height.res,y=height.fit)
spruce.lm%T>%plot%>%normcheck(,shapiro.wilk=TRUE)
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
quad.lm=lm(Height~BHDiameter + I(BHDiameter^2),data=spruce)
View(quad.lm)
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
quad.lm<-lm(Height~BHDiameter + I(BHDiameter^2),data=spruce)%>%fitted->quad.fit
quad.lm
quad.fit
ggplot(spruce,aes(y = Height,x=BHDiameter))+
geom_point() +
stat_smooth(method=lm, formula = y ~ x + I(x^2))
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
quad.lm<-lm(Height~BHDiameter + I(BHDiameter^2),data=spruce)
quad.lm%>%fitted->quad.fit
quad.fit
ggplot(spruce,aes(y = Height,x=BHDiameter))+
geom_point() +
stat_smooth(method=lm, formula = y ~ x + I(x^2))
View(quad.lm)
View(quad.lm)
class(quad.lm[coefficients])
class(quad.lm["coefficients"])
type(quad.lm["coefficients"])
typeof(quad.lm["coefficients"])
summary(spruce.lm)
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
quad.lm%T>%print%T>%summary%>%.$"coefficients"%>%data.frame(value=.,"beta-hat subscript"=0:2)
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
quad.lm%T>%print%T>%predict(.)%>%.$"coefficients"%>%
data.frame(value=.,"beta-hat subscript"=0:2)
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
quad.lm%T>%print%T>%predict(.)%>%.$"coefficients"%>%
data.frame(value=.,"beta-hat subscript"=0:2)
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
quad.lm%T>%print%T>%predict20x(.,spruce)%>%.$"coefficients"%>%
data.frame(value=.,"beta-hat subscript"=0:2)
mean(spruce)
summary(spruce)
View(quad.lm)
data.frame(x="",y=summary(quad.lm$model)["mean"]
)
summary(quad.lm$model)
View(quad.lm)
print(quad.lm$call$formula)
string(quad.lm$call$formula)
print(quad.lm$terms)
quad.lm
print(quad.lm$terms)
quad.lm$coefficients
quad.lm$coefficients%>%class
quad.lm$coefficients%>%typeof
View(quad.lm)
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
quad.lm%T>%print%T>%ciReg%>%
.$"coefficients"%T>%data.frame(value=.,"beta-hat subscript"=0:2)%>%
paste0(.[1]," = ","x","+x^2")
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
quad.lm%T>%print%T>%ciReg%>%
.$"coefficients"%T>%data.frame(value=.,"beta-hat subscript"=0:2)%>%
paste(.,c('=' ,'x',"x^2"),sep=" ",collapse=" ")
c(15,18,20)%>%data.frame(Height=.,BHDiameter=.)%>%map(c(spruce.lm,quad.lm),~predict(.,.x))
list(spruce.lm,quad.lm)
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
myStyle=function(k){kable(k,format="html",align='l')%>%
kable_styling("striped","condensed")%>%
column_spec(1, width="5cm")
}
quad.lm%T>%print%T>%ciReg%>%
.$"coefficients"%>%data.frame(value=.,"beta-hat subscript"=0:2)%>%myStyle
quad.lm%>%cireg$"coefficients"%>%paste(.,c('=' ,'x',"x^2"),sep=" ",collapse=" ")%>%myStyle
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
anova(quad.lm)
anova(spruce.lm)
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
anova(spruce.lm,quad.lm)
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
getwd()
tail(spruce)
spruce%T>%trendscatter(x=.$Height,y=.$BHDiameter,f=0.5)%>%lm()->spruce.lm
spruce.lm%T>%{residuals(.)->>height.res}%>%fitted->height.fit
qplot(x=height.res,y=height.fit)
trendscatter(x=height.res,y=height.fit)
spruce.lm%T>%plot%>%normcheck(,shapiro.wilk=TRUE)
summary(spruce.lm)
quad.lm<-lm(BHDiameter~Height + I(BHDiameter^2),data=spruce)
quad.lm%T>%{residuals(.)->>quad.res}%>%fitted->quad.fit
ggplot(spruce,aes(y = Height,x=BHDiameter))+
geom_point() +
stat_smooth(method=lm, formula = y ~ x + I(x^2))
quad.lm%T>%plot%>%normcheck(,shapiro.wilk=TRUE)
myStyle=function(k){kable(k,format="html",align='l')%>%
kable_styling("striped","condensed")%>%
column_spec(1, width="5cm")
}
quad.lm%T>%{print(summary(.))}%T>%ciReg->regs
regs$"coefficients"%>%data.frame(value=.,"beta-hat subscript"=0:2)%>%myStyle
regs$"coefficients"%>%paste(.,c('=' ,'x',"x^2"),sep=" ",collapse=" ")%>%data.frame("equation"=.)%>%myStyle
map(list(spruce.lm,quad.lm),predict,{c(15,18,20)%>%data.frame(Height=.,BHDiameter=.)})%>%
data.frame("LINEAR MODEL PREDICTIONS"=.[[1]],"QUADRATIC MODEL PREDICTIONS"=.[[2]])%>%select(3:4)%>%myStyle
anova(spruce.lm,quad.lm)
ffff<-anova(spruce.lm,quad.lm)
View(ffff)
rss(spruce.lm)
anova(spruce.lm,spruce)
anova(spruce,spruce.lm,quad.lm)
summary(spruce.lm)
View(ffff)
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
anova(spruce.lm,quad.lm)
anova(spruce.lm)
anova(quad.lm)
519-271
(519-271)/248
(519-15)/504
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(gridExtra)
library(lattice)
library(knitr)
library(data.table)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(utils)
library(kableExtra)
library(magrittr)
library(readxl)
library(plotrix)
library(s20x)
spruce <- read_csv("C:/Users/Adrienne/Dropbox/R/lab1/SPRUCE.csv")
cooks20x(quad.lm)->fffff
